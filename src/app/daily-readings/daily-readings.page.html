<app-menu-header></app-menu-header>
<ion-header>
  <ion-toolbar>
    <ion-button
      slot="start"
      routerLink="/home"
      routerDirection="back"
      aria-label="Go Back"
      tabindex="0"
      fill="clear">
      <ion-icon name="arrow-back" slot="icon-only" aria-hidden="true"></ion-icon>
    </ion-button>
    <ion-title>Daily Readings</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
<ion-grid>
  <ion-row>
    <ion-col class="ion-text-center" sizeLg="4" offsetLg="4" sizeMd="6" offsetMd="3" sizeSm="8" offsetSm="2">
<h2>Today's Readings</h2>
<app-date></app-date>

<!-- Loading State -->
<div *ngIf="isLoading" class="ion-text-center">
  <ion-spinner name="crescent"></ion-spinner>
  <p>Loading today's readings...</p>
</div>

<!-- Error State -->
<div *ngIf="error" class="ion-text-center" style="color: #ff4444; padding: 20px;">
  <p>{{ error }}</p>
  <ion-button (click)="loadDailyReadings()" fill="outline" size="small">
    Try Again
  </ion-button>
</div>

<!-- No Readings State -->
<div *ngIf="!isLoading && !error && readings.length === 0">
  <p>No readings found for today ({{today}}).</p>
</div>



<!-- Readings Display -->
<div *ngFor="let reading of readings; trackBy: trackByReading">

  <div *ngIf="isSabbath(reading)">
    <h3>Parshah: {{reading.parashah}}</h3>
    <p>{{getDayName(reading)}} - Sabbath Reading</p>

    <!-- Complete Torah Reading for Sabbath -->
    <ion-item button="true" (click)="handleReadingClick($event, reading.date, 'torah')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Complete Torah Reading:</h4>
        <p>{{formatTorahReading(reading)}}</p>
      </ion-label>
    </ion-item>

    <!-- Haftarah Reading for Sabbath -->
    <ion-item *ngIf="reading.haftarah" button="true" (click)="handleReadingClick($event, reading.date, 'haftarah')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Haftarah:</h4>
        <p>{{reading.haftarah}}</p>
      </ion-label>
    </ion-item>

  </div>

  <!-- Regular Daily Reading Display -->
  <div *ngIf="!isSabbath(reading)">
    <h3>Parshah: {{reading.parashah}}</h3>
    <p>{{getDayName(reading)}} - Daily Reading</p>

    <!-- Torah Reading -->
    <ion-item *ngIf="reading.torah" button="true" (click)="handleReadingClick($event, reading.date, 'torah')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Torah:</h4>
        <p>{{formatTorahReading(reading)}}</p>
      </ion-label>
    </ion-item>

    <!-- Writings Reading -->
    <ion-item *ngIf="reading.writings" button="true" (click)="handleReadingClick($event, reading.date, 'writings')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Ketuvium:</h4>
        <p>{{reading.writings}}</p>
      </ion-label>
    </ion-item>

    <!-- Prophets Reading -->
    <ion-item *ngIf="reading.prophets" button="true" (click)="handleReadingClick($event, reading.date, 'prophets')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Nevi'im:</h4>
        <p>{{reading.prophets}}</p>
      </ion-label>
    </ion-item>

    <!-- Brit Chadashah Reading -->
    <ion-item *ngIf="reading.britChadashah" button="true" (click)="handleReadingClick($event, reading.date, 'britChadashah')" style="cursor: pointer; pointer-events: auto;">
      <ion-label>
        <h4>Brit Chadashah:</h4>
        <p>{{reading.britChadashah}}</p>
      </ion-label>
    </ion-item>
  </div>
</div>
    </ion-col>
  </ion-row>
</ion-grid>

  <app-footer-landing></app-footer-landing>
</ion-content>
