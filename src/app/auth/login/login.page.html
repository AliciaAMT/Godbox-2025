<ion-header>
  <ion-toolbar>
    <ion-title>Login</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-fab vertical="top" horizontal="start" slot="fixed">
    <ion-fab-button routerLink="/landing" routerDirection="back">
      <ion-icon name="arrow-back"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <ion-grid>
    <ion-row>
      <ion-col>
        <div class="ion-text-center">
          <img src="../../assets/images/bible.webp" alt="logo">
        </div>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size-lg="4" offset-lg="4" size-md="6" offset-md="3" size-sm="8" offset-sm="2">
        <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
          <div class="input-group">
            <ion-item>
              <ion-label position="stacked"><ion-icon name="mail-outline"></ion-icon> Email</ion-label>
              <ion-input type="email" placeholder="Email" formControlName="email"></ion-input>
            </ion-item>
            <div *ngIf="(loginForm.get('email')?.dirty || loginForm.get('email')?.touched) && loginForm.get('email')?.errors" class="errors">
              <span *ngIf="loginForm.get('email')?.errors?.['required']">Email is required</span>
              <span *ngIf="loginForm.get('email')?.errors?.['email']">Email is invalid</span>
            </div>

            <ion-item>
              <ion-label position="stacked">
                <ion-icon name="lock-closed-outline"></ion-icon>
                Password
              </ion-label>
              <ion-input
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                placeholder="Password">
              </ion-input>
              <ion-icon
                slot="end"
                [name]="showPassword ? 'eye-off' : 'eye'"
                (click)="togglePassword()">
              </ion-icon>
            </ion-item>

            <div *ngIf="(loginForm.get('password')?.dirty || loginForm.get('password')?.touched) && loginForm.get('password')?.errors" class="errors">
              <span *ngIf="loginForm.get('password')?.errors?.['required']">Password is required</span>
              <span *ngIf="loginForm.get('password')?.errors?.['minlength']">Password needs to be 6 characters</span>
            </div>
          </div>

          <ion-button type="submit" expand="block" [disabled]="!loginForm.valid || isLoading">Log in</ion-button>
          <ion-button type="button" expand="block" routerLink="/auth/register">Create Account</ion-button>
          <ion-button type="button" expand="block" routerLink="/auth/forgot-password">Recover Password</ion-button>
          <ion-button type="button" expand="block" color="tertiary" (click)="onGoogleLogin()">
            <ion-icon name="logo-google" slot="start"></ion-icon>
            Sign in with Google
          </ion-button>
        </form>
        <div class="ion-padding">
          By registering you agree to our <a routerLink="/license">Terms of Service and Privacy Policy</a>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
